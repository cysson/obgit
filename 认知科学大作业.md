# EEG疲劳检测模型算法设计及对比分析报告

## 一、实验背景与要求

本次实验旨在利用机器学习方法对PVT范式诱发的脑电数据集进行疲劳检测算法设计。要求基于预处理后的脑电数据（包含5个频段的Power和DE特征），构建分类模型预测疲劳状态，并采用留一被试交叉验证（LOSO）方法评估模型。

数据集包含11名被试的脑电数据，具有被试间差异性大、时序特征利用难以及小样本学习等关键挑战。

## 二、模型对比分析

### （一）TCN模型与EEGNet Fusion模型的异同

  1. **相同点**
     * **输入数据类型** ：二者均以预处理后的脑电数据为输入，数据包含多个频段的Power和DE特征，输入数据均保留了原始的时空维度结构，以充分挖掘脑电数据中的空间和时间特征信息。
     * **目标任务** ：都是致力于解决疲劳检测的二分类问题，通过对脑电特征的学习和分析，实现对疲劳状态和非疲劳状态的准确预测。
     * **深度学习基础** ：都基于深度学习架构，通过构建多层神经网络结构来自动提取特征并进行分类，减少了传统手工特征提取的工作量和复杂度。

  2. **不同点**
     * **网络架构基础**
       * **TCN模型** ：以时序卷积网络（TCN）为核心架构。利用因果卷积、扩张卷积等技术，强调对时序数据的处理能力，通过扩张卷积扩大感受野，捕捉长时序依赖关系，同时保持计算效率和梯度稳定。
       * **EEGNet Fusion模型** ：基于EEGNet进行改进，采用多分支异构卷积与特征融合的设计。原始EEGNet通过深度可分离卷积等实现时空特征提取，EEGNet Fusion在此基础上引入3个独立分支，各分支超参数设置差异化，后经特征融合层整合特征，以增强对不同尺度特征的提取能力和跨被试鲁棒性。

     * **特征提取方式**
       * **TCN模型** ：着重于时序特征的挖掘，通过扩张卷积在时间维度上扩展感受野，捕捉不同时间尺度上的脑电模式变化，能够有效处理脑电数据中的长程依赖关系，例如疲劳过程中脑电频率的缓慢演变等。同时，结合残差连接、通道处理等，保留了电极间空间拓扑关系和频段特征，实现时空特征的综合提取。
       * **EEGNet Fusion模型** ：强调多尺度的时空特征融合。各分支分别以不同卷积核大小和滤波器数量提取不同尺度的局部和全局特征，如小卷积核提取高频细节特征、大卷积核提取低频全局模式等，特征融合层将各分支特征拼接，形成更丰富的联合特征表示，从而在一定程度上兼顾了不同被试的个体差异和多样化的脑电特征分布。

     * **模型复杂度与计算效率**
       * **TCN模型** ：相对轻量级，在参数量控制上具有一定优势，通过共享卷积核等机制提高参数效率，计算效率较高，可充分利用GPU等硬件的并行计算能力，适合处理长序列脑电数据，能快速完成训练和预测任务，前向传播耗时约15ms/样本（基于MPS设备）。
       * **EEGNet Fusion模型** ：由于多分支结构，参数量和计算量大幅增加，推理时间处理每个样本约需107–110ms，计算成本较高，其硬件加速需求更显著，对实时性要求高的应用场景存在一定限制，但通过模型量化或轻量化设计可一定程度上缓解这一问题。

### （二）训练方法对比

  1. **数据集划分与预处理**
     * **TCN模型** ：采用LOSO方法进行数据划分，1名被试作为测试集，10名作为训练集。数据加载时明确保留了EEG数据的原始时空结构（samples, timesteps, features），在测试代码中验证数据形状，确保输入符合TCN要求。未提及对数据进行Z-score标准化，但在数据处理过程中强调了对时序结构的保留和形状验证。
     * **EEGNet Fusion模型** ：同样采用LOSO交叉验证方法划分数据集。数据预处理采用Z-score方法对每个样本的Power和DE特征分别进行标准化处理，以消除不同特征的量纲差异，确保模型训练稳定性。使用PyTorch的DataLoader，设置批大小为32，并通过shuffle=True随机打乱样本顺序，增强模型对数据分布波动的鲁棒性。

  2. **模型优化器与学习率设置**
     * **TCN模型** ：优化器选择Adam，初始学习率设为0.001，添加了ReduceLROnPlateau调度器，当验证准确率不再提升时自动降低学习率，patience=5，factor=0.5，以平衡学习率衰减，避免梯度爆炸或消失问题。
     * **EEGNet Fusion模型** ：优化器选择AdamW，结合默认权重衰减（weight_decay=0.01），抑制过拟合的同时加速收敛。学习率设为0.0005，训练轮数200轮，低学习率配合长轮次训练，平衡收敛精度与速度。

  3. **训练过程监控与模型保存**
     * **TCN模型** ：在训练过程中监控验证准确率和损失函数的变化，当验证准确率稳定后，记录最终结果，通过观察训练日志分析模型的收敛稳定性和泛化能力。
     * **EEGNet Fusion模型** ：每轮训练后评估验证集准确率，自动保存性能最佳的模型参数，避免手动筛选。同时设置早停机制，当连续多轮验证集准确率无提升时终止训练，防止过度拟合某被试的异常特征。

  4. **硬件加速与计算效率优化**
     * **TCN模型** ：利用GPU等硬件的并行计算能力，通过TCN的并行处理优势提高计算效率，未提及具体的硬件调用优先级切换机制，但强调了其在处理长序列数据时的快速性。
     * **EEGNet Fusion模型** ：硬件调用优先使用CUDA GPU，其次切换至Apple M系列GPU（MPS接口），最后fallback至CPU。以M1芯片为例，通过MPS调用Apple Neural Engine可提升特征运算速度，显著缩短大规模训练时间，满足实时疲劳监测的计算效率需求。

### （三）选择TCN模型的原因及好处

  1. **原因**
     * **时序特征挖掘优势** ：疲劳检测任务中，脑电数据的时序特性至关重要。疲劳状态的产生和发展是一个动态过程，脑电特征随时间逐渐变化，如从清醒到疲劳过程中脑电频率的慢波化趋势等。TCN模型通过因果卷积和扩张卷积能够严格遵循时间因果性，并有效捕捉长时序依赖关系，精准模拟大脑实时电活动的时序演变，这是解决疲劳检测问题的关键因素。
     * **计算效率与资源适配** ：TCN模型具有较高的计算效率，可充分利用现代硬件的并行计算能力，训练和预测速度快。这对于大规模脑电数据的处理以及实时疲劳监测应用场景具有重要意义，能够满足实际应用中对快速响应的需求，如驾驶疲劳监测等场景中需要及时发出疲劳预警。
     * **模型性能表现** ：在本次实验中，TCN模型在验证集上取得了0.8544的准确率，显著超过作业要求的Topline值（0.75），且训练过程显示其具有良好的收敛稳定性和泛化能力，验证了其在疲劳检测任务中的有效性。

  2. **好处**
     * **高效的时序建模** ：能够深入挖掘脑电数据中的时间序列信息，提取出与疲劳状态相关的动态特征，提高了疲劳检测的准确性，使得模型能够更真实地反映疲劳发展的过程，为及时准确地检测疲劳状态提供有力支持。
     * **良好的可扩展性与灵活性** ：TCN模型的架构相对灵活，在面对不同长度的脑电序列数据以及不同频段特征组合等情况时，能够通过调整网络结构参数（如卷积核大小、扩张因子、网络层数等）进行适应性调整，具有较好的可扩展性，便于根据具体需求进行优化和改进。
     * **适应小样本学习问题** ：通过共享卷积核等机制提高了参数效率，在一定程度上缓解了小样本学习问题，避免了模型因参数量过大而出现过拟合的风险，使得在有限的脑电数据下仍能有效训练出高性能的疲劳检测模型。

## 三、应用场景调研

### （一）驾驶疲劳监测

  1. **需求分析** ：驾驶过程中疲劳是导致交通事故的重要因素之一。实时监测驾驶员的疲劳状态，及时发出预警，对于保障行车安全具有至关重要的意义。需要一个能够在车辆行驶过程中快速、准确地分析驾驶员脑电数据并判断其是否处于疲劳状态的系统。
  2. **模型适配性** ：TCN模型的高计算效率和实时性优势使其能够满足驾驶场景中对快速疲劳检测的需求。其前向传播耗时短，可在短时间内对驾驶员的脑电数据进行分析并给出疲劳状态预测，及时提醒驾驶员采取相应措施，如靠边休息等。同时，TCN对时序特征的挖掘能力有助于捕捉驾驶过程中疲劳的渐进发展过程，提高监测的准确性。

### （二）医疗监护中的疲劳评估

  1. **需求分析** ：在医疗领域，对于一些长期患病、身体虚弱或精神压力大的患者，疲劳状态可能影响其康复进程和生活质量。对患者进行疲劳评估有助于医护人员制定个性化的治疗和护理方案。例如，在神经康复治疗中，了解患者的疲劳程度可以合理安排康复训练计划，提高治疗效果。
  2. **模型适配性** ：TCN模型在处理脑电数据时保留了时空维度信息，能够综合考虑电极间空间分布和时序变化特征，有助于更全面地分析患者的脑电活动状态，从而更准确地评估疲劳程度。此外，其轻量级架构和良好的泛化能力使其可在医疗设备上进行部署，实现对患者疲劳状态的实时监测和长期跟踪。

### （三）工业生产中的疲劳检测

  1. **需求分析** ：在工业生产环境中，员工的疲劳状态可能导致操作失误，引发生产事故，影响生产效率和产品质量。尤其是在一些需要长时间集中注意力的工作岗位，如流水线作业、监控室操作等，对员工疲劳状态的实时监测和预警对于保障生产安全和效率具有重要作用。
  2. **模型适配性** ：TCN模型的高准确率和稳定性使其能够适应工业生产场景中对疲劳检测的严格要求。其对小样本学习的适应能力也有助于在不同工业场景、不同员工群体的数据条件下进行有效的疲劳检测模型训练，为工业生产中的疲劳监测提供可靠的技术支持。

### （四）消费电子领域的疲劳监测应用

  1. **需求分析** ：随着人们对健康和生活品质的关注度不断提高，消费电子产品如智能手环、智能头带等开始集成疲劳监测功能。这些产品希望通过分析用户的生理信号（包括脑电等）来评估其疲劳状态，为用户提供一个健康管理的参考，例如提醒用户合理安排作息、避免过度疲劳等。
  2. **模型适配性** ：TCN模型的轻量化和低计算成本特点使其适合在消费电子产品的嵌入式芯片上运行。其较低的前向传播耗时和硬件资源占用，能够满足消费电子产品对低功耗、实时性要求较高的特点，同时保证疲劳监测功能的准确性和可靠性，为消费者提供实用的疲劳监测服务。
  3. 好的，以下是为你生成的更详细的实验报告内容：

# 二、模型对比分析

## （一）EEGNet 模型

### 1. 传统 EEGNet 模型的尝试

为了有效解决疲劳监测算法中的二分类问题，我们首先尝试运用经典的 EEGNet 模型开展训练工作。EEGNet 是一种专为脑电信号（EEG）分类任务而精心设计的轻量级卷积神经网络（CNN）。其独特的设计核心在于巧妙地融合了深度可分离卷积以及针对 EEG 特性的特定架构优化策略，从而能够高效地提取脑电信号中的时空特征，并且具备出色的适配性，能够灵活应对多种不同的 BCI 范式，例如运动想象、P300 等应用场景。

  * **输入数据适配** ：EEGNet 在输入环节展现出别具一格的设计理念，它能够直接接受二维输入形式，即（Channels, Time Points），意味着可以将多通道 EEG 的原始时域信号直接作为输入数据。这种设计方式的优势在于无需像传统方法那样依赖 FFT、小波变换等手工特征提取操作。手工特征提取不仅存在丢失原始信号关键信息的风险，还会极大地增加整个处理流程的复杂性。而 EEGNet 直接以原始信号输入，借助网络自身的结构来自动学习和提取特征，从而能够最大程度地保留信号中蕴含的空间与时间信息。具体而言，它通过卷积层同时对空间（通道间）和时间（信号动态）特征进行学习，使得模型能够精准地捕捉到 EEG 信号中不同脑区之间的复杂空间关联以及信号随时间变化的精细动态特征，为后续的分类任务构建起坚实可靠的基础。
  * **分层特征提取** ：在分层特征提取环节，EEGNet 采用了精心构思的三层结构，以层层递进的方式逐步萃取 EEG 信号中的关键特征信息。
    * **第一层：频率滤波（Temporal Convolution）** ：该层运用尺寸为（1, kernel_size）的 2D 卷积核，例如（1, 64），沿着时间维度进行滑动操作，以此来提取信号中的频带特征。这一过程在功能上与传统的 FIR 滤波器有着相似之处，但关键区别在于 EEGNet 能够自动学习与具体任务紧密相关的频率成分。以运动想象任务为例，模型会自动聚焦于 μ 节律（8–12 Hz）和 β 节律（13–30 Hz）等关键频段，因为这些频段包含了与运动想象行为紧密关联的重要信息。通过这种基于自动学习的机制，EEGNet 能够更加精准地捕捉到不同任务场景下 EEG 信号的独特频率特征，为后续的特征提取流程提供更具针对性和有效性的输入。
    * **第二层：空间滤波（Depthwise Convolution）** ：此层采用深度可分离卷积（Depthwise Conv）技术，使用尺寸为（Channels, 1）的卷积核，先针对每个通道的时间特征进行独立处理，然后再将处理后的结果进行有效的合并。这种操作方式带来了多方面显著优势。首先，它能够大幅减少模型的参数量，与传统的 2D 卷积相比，在降低模型复杂度方面表现出色，这对于 EEG 数据样本量通常较小的情况来说意义重大，有效避免了模型因参数量过大而出现过拟合的问题。其次，它还能够高效地提取通道间的空间关系特征，例如左右脑区在不同任务执行过程中的活动差异情况，从而使模型能够从空间维度深入理解 EEG 信号的特征分布规律。
    * **第三层：时空特征融合（Separable Convolution）** ：该层通过可分离卷积（Depthwise + Pointwise Conv）技术进一步实现时空特征的深度融合。其中，Depthwise 部分采用尺寸为（kernel_size, 1）的卷积核，如（16, 1），沿着时间维度对特征进行汇总操作，能够精准地捕捉到信号在时间序列上的长期依赖关系；而 Pointwise 部分则使用尺寸为（1, 1）的卷积核，对跨特征通道的信息进行高效混合，实现了不同通道特征之间的交互与融合。这种独特的设计在有效减少计算量的同时，能够显著增强特征的表达能力，使模型能够学习到更为抽象、更具判别性的时空特征，为最终的分类决策提供坚实有力的支持。

  * **正则化与优化** ：为了全方位提升模型的性能以及泛化能力，EEGNet 在正则化与优化环节采取了一系列行之有效的措施。首先，在每个卷积层后都加入了批归一化（BatchNorm）操作，这一操作能够对输入数据进行标准化处理，使得各层的输入分布更加稳定，从而加速模型的训练过程，并且能够显著提升模型的泛化能力，使其在面对新的测试数据时能够表现出更加出色的性能。其次，在激活函数的选择上，模型采用了 ELU（Exponential Linear Unit）函数，相较于传统的 ReLU 函数，ELU 能够更好地适应 EEG 信号中存在正负波动的特点。因为 EEG 信号本身具有正负波动的特性，而 ELU 函数在负值区域的平滑过渡特性使得模型能够更加自然流畅地处理这些信号，进而增强模型的非线性表达能力。此外，模型还巧妙地结合了平均池化（Average Pooling）和 Dropout（概率 0.5）技术。平均池化操作用于降低特征维度，从而减少计算量，同时在一定程度上保留了特征的整体信息；而 Dropout 技术则通过随机丢弃部分神经元的输出，有效防止了过拟合现象的发生，使模型能够更加专注于学习数据的本质特征，而不是过度拟合训练数据中的噪声信息。
  * **分类输出** ：在完成上述特征提取和处理流程之后，EEGNet 通过全连接层和 Softmax 函数实现最终的分类输出。全连接层负责将前面提取到的时空特征进行整合，形成一个综合全面的特征表示，然后通过 Softmax 函数将其映射到各个类别对应的概率值上。例如，在针对左手 / 右手运动想象任务的分类场景中，Softmax 函数会输出该信号分别属于左手运动想象和右手运动想象的概率值，模型依据这些概率值进行精准的分类决策。这种分类输出设计简洁而高效，能够充分利用前面各层提取到的丰富特征信息，实现对 EEG 信号的准确分类，为后续的应用场景提供可靠的支持。

### 2.EEGNet 的核心创新点及性能表现

  * **核心创新点** ：EEGNet 在脑电信号处理领域凭借多项核心创新点脱颖而出。首先是轻量化设计，深度可分离卷积的应用使得 EEGNet 的参数量大幅减少，仅约为 2,000 – 3,000，相较于传统的 CNN 模型有着明显的优势。这一特性使其特别适合处理小样本的 EEG 数据，有效避免了因参数量过大而导致的过拟合问题，同时也显著降低了模型的计算复杂度，使其能够在资源有限的设备上稳定运行，极大地拓展了其应用场景。其次是跨范式通用性，EEGNet 的同一架构能够无缝处理多种不同的 BCI 任务，包括但不限于运动想象（MI）、P300、ERN 等，无需对模型结构进行任何调整。这一特点不仅大大提高了模型的实用性和灵活性，更是为研究人员和开发者节省了大量的时间和精力，无需为不同类型的 BCI 任务分别设计专用的模型。最后是端到端学习能力，EEGNet 能够直接从原始 EEG 信号中自动学习时空特征，完全避免了手工特征工程所带来的各种局限性。手工特征提取往往需要依赖专业知识和丰富经验，且提取的特征可能无法完全捕捉到信号中的关键信息，而端到端学习能够让模型自主地发现最有利于分类任务的特征，从而显著提高了特征提取的效率和准确性，为脑电信号处理领域带来了革命性的进步。
  * **性能对比** ：在性能方面，EEGNet 在多个权威的公开数据集上均表现出色。例如在 BCI Competition IV 2a 数据集上，其准确率不仅达到了传统方法（如 CSP+SVM）的水平，甚至在某些情况下还实现了超越，同时与一些复杂的深度学习模型相比也毫不逊色。这充分证明了 EEGNet 在脑电信号分类任务中具备卓越的有效性和优越性。此外，EEGNet 还具有计算成本低的显著优势，这对于实时 BCI 应用来说具有至关重要的意义。例如在嵌入式设备上的部署场景中，较低的计算成本意味着模型能够快速处理 EEG 信号，实现实时的分类和反馈。这对于实际的 BCI 应用场景，如脑控机器人、神经康复等，具有极大的推动作用，能够显著提升系统的实用性和用户体验。
  * **选择 EEGNet 的原因** ：在实现疲劳监测算法时，我们选择经典的 EEGNet 作为基础模型，主要基于以下几个关键原因。首先，EEGNet 的时空分离卷积策略完美地匹配了 EEG 信号的独特生理特性。该策略先针对时间维度进行特征提取，再对空间维度的特征进行处理，这种有序的处理流程能够更加有效地捕捉到 EEG 信号中蕴含的丰富时空特征信息。其次，EEGNet 在轻量化和通用性之间实现了精妙的平衡。它既能在小样本数据上取得良好的性能表现，又能灵活适配多种 BCI 任务，成为了 BCI 领域的基准模型，为后续的研究和应用提供了坚实的参考基础。最后，EEGNet 的端到端训练方式极大地简化了信号处理的流程，提升了特征表达的自动化程度，减少了对人工特征工程的依赖。尽管后续出现了 EEGNet Fusion 等改进模型，通过多分支扩展进一步提升了跨被试性能，但 EEGNet 的核心思想依然是当前 EEG 深度学习的基础范式，为脑电信号处理领域的持续发展奠定了重要的基础。

## （二）EEGNet Fusion 模型

为满足实验对于更高性能的需求，进一步提升 EEGNet 模型在疲劳监测任务中的表现，我们最终选定 EEGNet Fusion 模型进行深入训练，以期达到最佳的实验效果。

### 1. 核心改进

  * **多分支异构设计** ：传统的 EEGNet 采用单一的分支架构，其超参数如卷积核大小和滤波器数量固定不变。这种相对单一的设计在面对不同被试之间存在显著差异的 EEG 信号时，难以充分适应个体间的独特特征差异。而 EEGNet Fusion 独辟蹊径，创新性地引入了 3 个相互独立的分支结构，每个分支均以 EEGNet 结构作为基础框架，但在超参数设置上呈现出明显的差异化特点。其中，分支 1 配备了较小的卷积核（4）和相对较少的滤波器（64），这使得它能够更加精细地捕捉 EEG 信号中的局部细节特征；分支 2 采用中等大小的卷积核（8）和中等数量的滤波器（128），从而在局部特征与全局特征之间实现了良好的平衡；分支 3 则使用较大的卷积核（16）和较多的滤波器（256），便于有效地提取更广泛的全局特征模式。这种多分支异构设计的核心目标在于，通过不同尺度的特征提取机制，全面覆盖不同被试 EEG 信号的多样化特征分布，从而能够更加有效地应对个体间的信号差异问题，提升模型在不同被试数据上的适应性和泛化能力。
  * **特征融合层** ：EEGNet Fusion 在分类层之前精心设计并新增了特征融合层。具体操作是将三个独立分支输出的最终特征图进行拼接（Concatenate）处理。这一设计的巧妙之处在于，每个分支凭借其独特的超参数配置，能够捕捉到 EEG 信号中不同维度的特征信息。例如，分支 1 在提取局部细节特征方面表现出色，而分支 3 则专注于全局模式的提取。当这些来自不同分支的特征图被拼接在一起时，便形成了一个包含多尺度、多维度信息的联合特征表示。这种联合特征表示相较于单一分支的输出，不仅蕴含了更丰富的语义信息，而且具备更强的表达能力。通过这种特征融合机制，模型能够充分融合并利用各分支提取的优势特征，从而显著增强对跨被试数据的泛化能力，使其在不同被试的 EEG 信号分类任务中表现出更加稳健和可靠的性能，有效提升了模型的整体鲁棒性。
  * **超参数调整** ：EEGNet Fusion 对各分支的超参数进行了细致入微的精心调整，主要体现在滤波器数量和卷积核大小的差异化精准配置上。这种差异化的超参数设置并非随意为之，而是基于对 EEG 信号的生理特性以及分类任务具体需求的深入理解和分析进行设计的。例如，较小的卷积核搭配较少的滤波器，使其能够精准地捕捉信号中的高频细节以及局部特征；而较大的卷积核配合较多的滤波器，则更有利于提取低频的全局模式以及空间特征。通过这种针对性极强的超参数调整策略，不同分支能够各自专注于提取不同频率范围和时空尺度的特征信息，从而在整体上实现对 EEG 信号全方位、多层次的特征覆盖，为跨被试分类任务提供更加全面、细致且有效的特征支持，进一步提升模型的分类准确性和可靠性。

### 2. 改进效果

  * **分类准确率显著提升** ：在针对跨被试任务的严谨实验验证中，基于权威的 PhysioNet 数据集开展的测试结果显示，EEGNet Fusion 在执行运动分类任务时取得了 84.1% 的准确率，相较于原 EEGNet 的 65.8%，实现了高达 18.3% 的显著提升；而在想象运动分类任务中，其准确率更是达到了 83.8%，较 EEGNet 的 68.2% 提升了 15.6%。这一系列显著的准确率提升并非偶然现象，而是多分支异构设计以及特征融合机制共同作用的必然结果。多分支结构使得模型能够从多个不同角度全面捕捉 EEG 信号的特征信息，而特征融合则将这些相互补充的特征信息进行有机整合，从而极大地提高了分类的准确性。此外，通过严格的 McNemar 检验证实，这种改进具有极高的统计显著性（p < 0.001），充分说明了 EEGNet Fusion 在跨被试分类任务中的有效性和可靠性，为疲劳监测等实际应用任务提供了更为精准的分类支持。
  * **跨被试鲁棒性增强** ：由于 EEG 信号本身存在着极大的个体差异，这给跨被试分类任务带来了巨大的挑战。EEGNet Fusion 凭借其多分支结构，允许模型同时学习不同被试的多样化特征模式，从而能够有效减少个体差异对分类结果的不利影响，显著增强了模型的跨被试鲁棒性。在与其他多个基准模型的对比实验中，EEGNet Fusion 的表现尤为突出，其准确率全面优于 ShallowConvNet（77%）和 DeepConvNet（76%）等传统模型。这充分表明，EEGNet Fusion 的设计理念能够更好地适应 EEG 信号的个体差异特性，为跨被试 BCI 系统的开发和应用提供了更优的解决方案，推动了 BCI 技术在实际场景中的广泛应用。
  * **计算成本增加** ：尽管 EEGNet Fusion 在分类准确率方面取得了令人瞩目的显著提升，但这一改进也不可避免地带来了计算成本的增加。在推理时间方面，该模型处理每个样本大约需要 107 – 110 毫秒，这一时间是 ShallowConvNet（23 毫秒）的 4 倍左右。计算成本的上升主要归因于多分支结构所导致的参数量和计算量的显著增加。然而，在实际应用过程中，这种计算代价的增加需要根据具体的应用场景和需求进行权衡考量。对于医疗 BCI 等对精度要求极为严苛的场景，分类准确率的提升具有至关重要的意义，因此较高的计算成本是完全可以接受的；但对于一些对实时性要求极高的应用场景，可能需要在精度和计算效率之间寻求一个更为适宜的平衡点，以满足实际应用的实时性要求。

### 3. 局限性

  * **计算效率** ：EEGNet Fusion 的多分支架构虽然在分类性能上取得了显著的提升，但也导致了参数量和计算量的大幅增加。这一变化在一定程度上限制了其在对实时性要求极高的应用场景中的使用范围。例如，在需要快速响应的脑机接口设备中，较高的计算延迟可能会对系统的实时交互性能产生负面影响，进而影响用户体验和系统效能。因此，如何在保持高精度的同时有效提高计算效率，成为了该模型在实际应用中亟待解决的关键问题，需要进一步的研究和优化工作来缓解这一矛盾。
  * **分支数量固定** ：在目前的研究阶段，EEGNet Fusion 仅对 3 分支的结构进行了充分的测试和验证。而对于增加分支数量的情况，其可能带来的收益与成本增加尚未进行深入且全面的验证。虽然理论上增加分支数量可能会进一步提高模型对特征的覆盖能力，从而提升分类性能，但与此同时，计算复杂度可能会呈指数级增长，这将对模型的训练和部署带来巨大的挑战。因此，未来的研究需要进一步探索分支数量与模型性能、计算成本之间的关系，以确定最优的分支数量配置方案，实现模型性能和计算效率的最佳平衡，为模型的广泛应用提供更加可靠的保障。
  * **任务通用性** ：当前 EEGNet Fusion 的有效性主要在运动想象 / 执行任务中得到了充分的验证，而对于其他类型的 EEG 范式，如 P300 等，其适应性和有效性尚未得到明确的证实。不同的 EEG 范式具有各自独特的信号特征和生成机制，因此模型在不同任务中的表现可能存在显著差异。为了进一步拓展 EEGNet Fusion 的应用范围，使其能够在更多的 BCI 任务中发挥其优势，需要开展针对不同 EEG 范式的深入研究，并根据各个任务的具体特点对模型进行相应的针对性优化工作。

### 4. 设计启示

  * **核心思想** ：EEGNet Fusion 的设计蕴含着两个至关重要且极具前瞻性的核心思想。其一为异构多分支设计理念，通过采用不同超参数组合的分支结构，使模型能够覆盖更为广泛的特征空间，从而更加有效地应对 EEG 信号中存在的个体差异问题；其二为特征融合思想，通过将各分支输出的特征图进行拼接融合，形成具有更强表达能力的联合特征表示，进而显著提升模型的分类性能。这两个核心思想为 EEG 深度学习模型的设计提供了极具价值的参考方向，即通过构建多样化的特征提取机制以及有效的特征融合策略，来增强模型对复杂多变的 EEG 信号的处理能力，为 BCI 技术的发展和应用开辟了新的路径。
  * **适用场景** ：基于 EEGNet Fusion 的独特设计特点，其主要适用于以下特定的应用场景。首先，在跨被试 EEG 分类任务中，该模型能够有效地解决由于个体差异大而导致的分类性能下降问题，展现出显著的优势。其次，对于那些对计算资源相对不敏感，但对分类精度有着极高要求的 BCI 系统，例如医疗诊断、高精度脑机接口控制等领域，EEGNet Fusion 能够充分发挥其高精度的优势，为相关领域的研究和应用提供强有力的支持。在这些应用场景中，尽管模型的计算成本有所增加，但通过采用硬件加速技术或其他优化手段，可以在一定程度上缓解计算效率的问题，从而确保模型在实际应用中的有效性和可行性。

## （三）EEGNet-TCN 模型

### 1. 整体架构图

（此处可插入 EEGNet-TCN 模型整体架构图，详细展示模型各组件的连接关系和数据流向，包括因果卷积、扩张卷积、残差连接和通道处理等关键模块在模型中的具体位置以及它们之间的交互关系，以便读者能够更加直观地理解模型的整体结构和工作流程。）

### 2. 关键组件说明

  * **因果卷积** ：因果卷积作为 TCN 处理时序数据的核心逻辑之一，在脑电信号分析场景中发挥着至关重要的作用。它严格遵循 “时间因果性” 原则，即确保模型的输出仅依赖于当前时刻以及历史时刻的脑电输入数据，彻底排除了未来时刻信号的干扰。例如，在疲劳检测任务中，当对某一时刻（如 t 时刻）的脑电信号特征进行分析时，因果卷积能够严格保证模型仅利用 t 时刻以及 t 时刻之前通过 59 电极、5 频段采集到的数据，从而精准地模拟大脑实时电活动的时序依赖关系。这种设计有效避免了因 “未来信息泄漏” 所导致的模型逻辑失真问题，使得疲劳状态的动态演变过程（从清醒到困倦的脑电渐变）能够被更加真实、准确地捕捉与学习，为疲劳监测提供了可靠的时序基础。
  * **扩张卷积** ：扩张卷积通过采用指数增长的扩张因子（如 d = 1, 2, 4…），在不显著增加计算量的前提下，能够大幅拓宽模型对脑电信号的 “时间视野”，使其能够捕捉到更长时间范围内的信号特征。以疲劳检测为例，不同疲劳阶段的脑电模式可能分布在不同的时间尺度上。在短时间内（例如当扩张因子 d = 1 对应较小的感受野时），模型可以精准捕捉脑电信号的快速波动，如在注意力短暂分散时 θ 波发生的细微变化；而在长时间跨度下（例如当扩张因子 d = 4 对应较大的感受野时），模型则能够覆盖数分钟内的慢波演化趋势，例如 α 波随着深度疲劳逐渐增强的变化规律。这种多尺度感受野的覆盖方式，使得模型能够从 59 电极、5 频段的连续时序数据中挖掘出从瞬时到长程的多维度疲劳相关特征，完美适配脑电信号非平稳、多时间尺度的复杂特性，为全面而深入的疲劳分析提供了有力支持。
  * **残差连接** ：在 TCN 由多级残差块堆叠构成的网络结构中，残差连接扮演着 “梯度高速公路” 的关键角色。在处理脑电信号时，为了挖掘诸如跨电极、跨频段的疲劳耦合模式等复杂特征，需要构建深层网络结构。然而，传统的深层网络往往容易受到梯度消失问题的困扰，导致模型训练过程停滞不前。残差连接通过直接将输入梯度传递到输出端，使得模型在训练涉及 59 电极、5 频段的高维脑电数据时，梯度能够更加顺畅地进行反向传播。例如，在多个残差块堆叠的结构中，每一层的梯度不仅来源于当前块自身的学习过程，还能从输入端直接获得 “接力” 传递过来的梯度信息，从而保障深层网络能够持续有效地更新参数。这使得模型能够精准提取脑电信号中那些细微但关键的疲劳特征，如前额叶与顶叶电极在疲劳状态下所展现出的协同变化模式，进而提升模型对疲劳状态的识别能力。
  * **通道处理** ：通道处理技术巧妙地将脑电信号的电极空间维度（59 电极）与频率维度（5 频段）统一映射为模型的 “通道维度”，实现了空间与频率信息的有机融合。这种设计使得 TCN 能够同时利用空间和频率双重信息进行特征学习。具体而言，59 电极对应着大脑不同区域的空间通道，能够捕捉到额叶、顶叶、枕叶等不同脑区在疲劳状态下的差异化响应特征，例如前额叶在疲劳时 θ 波增强更为显著；而 5 频段作为频率通道，则能够清晰地区分 Delta（与困倦状态相关）、Beta（与清醒状态相关）等不同节律对疲劳状态的贡献。通过将电极和频段协同建模为通道，模型能够学习到 “特定脑区 + 特定频段” 的联合特征，例如顶叶 Alpha 波能量变化与疲劳状态的紧密关联，从而充分挖掘脑电信号中蕴含的丰富时空特性对疲劳检测的重要价值，为高精度的疲劳监测提供坚实的特征基础。

