# EEG疲劳检测模型算法设计及对比分析报告

## 一、实验背景与要求

本次实验旨在利用机器学习方法对PVT范式诱发的脑电数据集进行疲劳检测算法设计。要求基于预处理后的脑电数据（包含5个频段的Power和DE特征），构建分类模型预测疲劳状态，并采用留一被试交叉验证（LOSO）方法评估模型。

数据集包含11名被试的脑电数据，具有被试间差异性大、时序特征利用难以及小样本学习等关键挑战。

## 二、模型对比分析

### （一）TCN模型与EEGNet Fusion模型的异同

  1. **相同点**
     * **输入数据类型** ：二者均以预处理后的脑电数据为输入，数据包含多个频段的Power和DE特征，输入数据均保留了原始的时空维度结构，以充分挖掘脑电数据中的空间和时间特征信息。
     * **目标任务** ：都是致力于解决疲劳检测的二分类问题，通过对脑电特征的学习和分析，实现对疲劳状态和非疲劳状态的准确预测。
     * **深度学习基础** ：都基于深度学习架构，通过构建多层神经网络结构来自动提取特征并进行分类，减少了传统手工特征提取的工作量和复杂度。

  2. **不同点**
     * **网络架构基础**
       * **TCN模型** ：以时序卷积网络（TCN）为核心架构。利用因果卷积、扩张卷积等技术，强调对时序数据的处理能力，通过扩张卷积扩大感受野，捕捉长时序依赖关系，同时保持计算效率和梯度稳定。
       * **EEGNet Fusion模型** ：基于EEGNet进行改进，采用多分支异构卷积与特征融合的设计。原始EEGNet通过深度可分离卷积等实现时空特征提取，EEGNet Fusion在此基础上引入3个独立分支，各分支超参数设置差异化，后经特征融合层整合特征，以增强对不同尺度特征的提取能力和跨被试鲁棒性。

     * **特征提取方式**
       * **TCN模型** ：着重于时序特征的挖掘，通过扩张卷积在时间维度上扩展感受野，捕捉不同时间尺度上的脑电模式变化，能够有效处理脑电数据中的长程依赖关系，例如疲劳过程中脑电频率的缓慢演变等。同时，结合残差连接、通道处理等，保留了电极间空间拓扑关系和频段特征，实现时空特征的综合提取。
       * **EEGNet Fusion模型** ：强调多尺度的时空特征融合。各分支分别以不同卷积核大小和滤波器数量提取不同尺度的局部和全局特征，如小卷积核提取高频细节特征、大卷积核提取低频全局模式等，特征融合层将各分支特征拼接，形成更丰富的联合特征表示，从而在一定程度上兼顾了不同被试的个体差异和多样化的脑电特征分布。

     * **模型复杂度与计算效率**
       * **TCN模型** ：相对轻量级，在参数量控制上具有一定优势，通过共享卷积核等机制提高参数效率，计算效率较高，可充分利用GPU等硬件的并行计算能力，适合处理长序列脑电数据，能快速完成训练和预测任务，前向传播耗时约15ms/样本（基于MPS设备）。
       * **EEGNet Fusion模型** ：由于多分支结构，参数量和计算量大幅增加，推理时间处理每个样本约需107–110ms，计算成本较高，其硬件加速需求更显著，对实时性要求高的应用场景存在一定限制，但通过模型量化或轻量化设计可一定程度上缓解这一问题。

### （二）训练方法对比

  1. **数据集划分与预处理**
     * **TCN模型** ：采用LOSO方法进行数据划分，1名被试作为测试集，10名作为训练集。数据加载时明确保留了EEG数据的原始时空结构（samples, timesteps, features），在测试代码中验证数据形状，确保输入符合TCN要求。未提及对数据进行Z-score标准化，但在数据处理过程中强调了对时序结构的保留和形状验证。
     * **EEGNet Fusion模型** ：同样采用LOSO交叉验证方法划分数据集。数据预处理采用Z-score方法对每个样本的Power和DE特征分别进行标准化处理，以消除不同特征的量纲差异，确保模型训练稳定性。使用PyTorch的DataLoader，设置批大小为32，并通过shuffle=True随机打乱样本顺序，增强模型对数据分布波动的鲁棒性。

  2. **模型优化器与学习率设置**
     * **TCN模型** ：优化器选择Adam，初始学习率设为0.001，添加了ReduceLROnPlateau调度器，当验证准确率不再提升时自动降低学习率，patience=5，factor=0.5，以平衡学习率衰减，避免梯度爆炸或消失问题。
     * **EEGNet Fusion模型** ：优化器选择AdamW，结合默认权重衰减（weight_decay=0.01），抑制过拟合的同时加速收敛。学习率设为0.0005，训练轮数200轮，低学习率配合长轮次训练，平衡收敛精度与速度。

  3. **训练过程监控与模型保存**
     * **TCN模型** ：在训练过程中监控验证准确率和损失函数的变化，当验证准确率稳定后，记录最终结果，通过观察训练日志分析模型的收敛稳定性和泛化能力。
     * **EEGNet Fusion模型** ：每轮训练后评估验证集准确率，自动保存性能最佳的模型参数，避免手动筛选。同时设置早停机制，当连续多轮验证集准确率无提升时终止训练，防止过度拟合某被试的异常特征。

  4. **硬件加速与计算效率优化**
     * **TCN模型** ：利用GPU等硬件的并行计算能力，通过TCN的并行处理优势提高计算效率，未提及具体的硬件调用优先级切换机制，但强调了其在处理长序列数据时的快速性。
     * **EEGNet Fusion模型** ：硬件调用优先使用CUDA GPU，其次切换至Apple M系列GPU（MPS接口），最后fallback至CPU。以M1芯片为例，通过MPS调用Apple Neural Engine可提升特征运算速度，显著缩短大规模训练时间，满足实时疲劳监测的计算效率需求。

### （三）选择TCN模型的原因及好处

  1. **原因**
     * **时序特征挖掘优势** ：疲劳检测任务中，脑电数据的时序特性至关重要。疲劳状态的产生和发展是一个动态过程，脑电特征随时间逐渐变化，如从清醒到疲劳过程中脑电频率的慢波化趋势等。TCN模型通过因果卷积和扩张卷积能够严格遵循时间因果性，并有效捕捉长时序依赖关系，精准模拟大脑实时电活动的时序演变，这是解决疲劳检测问题的关键因素。
     * **计算效率与资源适配** ：TCN模型具有较高的计算效率，可充分利用现代硬件的并行计算能力，训练和预测速度快。这对于大规模脑电数据的处理以及实时疲劳监测应用场景具有重要意义，能够满足实际应用中对快速响应的需求，如驾驶疲劳监测等场景中需要及时发出疲劳预警。
     * **模型性能表现** ：在本次实验中，TCN模型在验证集上取得了0.8544的准确率，显著超过作业要求的Topline值（0.75），且训练过程显示其具有良好的收敛稳定性和泛化能力，验证了其在疲劳检测任务中的有效性。

  2. **好处**
     * **高效的时序建模** ：能够深入挖掘脑电数据中的时间序列信息，提取出与疲劳状态相关的动态特征，提高了疲劳检测的准确性，使得模型能够更真实地反映疲劳发展的过程，为及时准确地检测疲劳状态提供有力支持。
     * **良好的可扩展性与灵活性** ：TCN模型的架构相对灵活，在面对不同长度的脑电序列数据以及不同频段特征组合等情况时，能够通过调整网络结构参数（如卷积核大小、扩张因子、网络层数等）进行适应性调整，具有较好的可扩展性，便于根据具体需求进行优化和改进。
     * **适应小样本学习问题** ：通过共享卷积核等机制提高了参数效率，在一定程度上缓解了小样本学习问题，避免了模型因参数量过大而出现过拟合的风险，使得在有限的脑电数据下仍能有效训练出高性能的疲劳检测模型。

## 三、应用场景调研

### （一）驾驶疲劳监测

  1. **需求分析** ：驾驶过程中疲劳是导致交通事故的重要因素之一。实时监测驾驶员的疲劳状态，及时发出预警，对于保障行车安全具有至关重要的意义。需要一个能够在车辆行驶过程中快速、准确地分析驾驶员脑电数据并判断其是否处于疲劳状态的系统。
  2. **模型适配性** ：TCN模型的高计算效率和实时性优势使其能够满足驾驶场景中对快速疲劳检测的需求。其前向传播耗时短，可在短时间内对驾驶员的脑电数据进行分析并给出疲劳状态预测，及时提醒驾驶员采取相应措施，如靠边休息等。同时，TCN对时序特征的挖掘能力有助于捕捉驾驶过程中疲劳的渐进发展过程，提高监测的准确性。

### （二）医疗监护中的疲劳评估

  1. **需求分析** ：在医疗领域，对于一些长期患病、身体虚弱或精神压力大的患者，疲劳状态可能影响其康复进程和生活质量。对患者进行疲劳评估有助于医护人员制定个性化的治疗和护理方案。例如，在神经康复治疗中，了解患者的疲劳程度可以合理安排康复训练计划，提高治疗效果。
  2. **模型适配性** ：TCN模型在处理脑电数据时保留了时空维度信息，能够综合考虑电极间空间分布和时序变化特征，有助于更全面地分析患者的脑电活动状态，从而更准确地评估疲劳程度。此外，其轻量级架构和良好的泛化能力使其可在医疗设备上进行部署，实现对患者疲劳状态的实时监测和长期跟踪。

### （三）工业生产中的疲劳检测

  1. **需求分析** ：在工业生产环境中，员工的疲劳状态可能导致操作失误，引发生产事故，影响生产效率和产品质量。尤其是在一些需要长时间集中注意力的工作岗位，如流水线作业、监控室操作等，对员工疲劳状态的实时监测和预警对于保障生产安全和效率具有重要作用。
  2. **模型适配性** ：TCN模型的高准确率和稳定性使其能够适应工业生产场景中对疲劳检测的严格要求。其对小样本学习的适应能力也有助于在不同工业场景、不同员工群体的数据条件下进行有效的疲劳检测模型训练，为工业生产中的疲劳监测提供可靠的技术支持。

### （四）消费电子领域的疲劳监测应用

  1. **需求分析** ：随着人们对健康和生活品质的关注度不断提高，消费电子产品如智能手环、智能头带等开始集成疲劳监测功能。这些产品希望通过分析用户的生理信号（包括脑电等）来评估其疲劳状态，为用户提供一个健康管理的参考，例如提醒用户合理安排作息、避免过度疲劳等。
  2. **模型适配性** ：TCN模型的轻量化和低计算成本特点使其适合在消费电子产品的嵌入式芯片上运行。其较低的前向传播耗时和硬件资源占用，能够满足消费电子产品对低功耗、实时性要求较高的特点，同时保证疲劳监测功能的准确性和可靠性，为消费者提供实用的疲劳监测服务。